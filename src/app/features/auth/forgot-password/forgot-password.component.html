<div class="auth-container">
  <div class="auth-card glass-card">
    <a routerLink="/auth/login" class="back-link">
      <lucide-icon [img]="icons.ArrowLeft" size="18"></lucide-icon>
      Volver al login
    </a>

    @if (!isSubmitted()) {
      <h1>Recuperar Contraseña</h1>
      <p class="subtitle">Te enviaremos un enlace para reestablecer tu acceso</p>

      @if (errorMessage()) {
        <div class="error-alert">
          {{ errorMessage() }}
        </div>
      }

      <form [formGroup]="forgotForm" (ngSubmit)="onSubmit()" class="auth-form">
        <div class="form-group">
          <label for="email">Email</label>
          <div class="input-wrapper">
            <input
              id="email"
              type="email"
              formControlName="email"
              placeholder="tu@email.com"
              [class.error]="forgotForm.get('email')?.touched && forgotForm.get('email')?.invalid"
            />
            <lucide-icon [img]="icons.Mail" class="input-icon" size="18"></lucide-icon>
          </div>
          @if (getErrorMessage('email')) {
            <span class="error-message">{{ getErrorMessage('email') }}</span>
          }
        </div>

        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="forgotForm.invalid || isLoading()"
        >
          @if (isLoading()) {
            <span class="loading">Enviando enlace...</span>
          } @else {
            <span>Enviar Enlace</span>
          }
        </button>
      </form>
    } @else {
      <div class="success-state fade-in">
        <div class="success-icon">
          <lucide-icon [img]="icons.CheckCircle" size="48"></lucide-icon>
        </div>
        <h2>¡Correo Enviado!</h2>
        <p>Hemos enviado instrucciones a <strong>{{ forgotForm.value.email }}</strong> para que puedas recuperar tu cuenta.</p>
        <button class="btn btn-primary" routerLink="/auth/login">
          Ir al Login
        </button>
      </div>
    }
  </div>
</div>
